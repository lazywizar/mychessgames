<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - MyChessGames</title>
    <link rel="stylesheet" href="css/template.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="./js/config.js"></script>
    <script src="./js/auth.js"></script>
</head>
<body>
    <!-- Navigation -->
    <div id="nav-placeholder"></div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="dashboard-container">
            <div id="gamesContainer">
                <div id="emptyState" class="empty-state" style="display: none;">
                    <h2>Welcome to MyChessGames!</h2>
                    <p>You haven't uploaded any games yet. Click "Add Games" to get started.</p>
                </div>

                <div id="gamesTable" class="games-table" style="display: none;">
                    <table>
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>White</th>
                                <th>Black</th>
                                <th>Result</th>
                                <th>Event</th>
                                <th>ECO</th>
                            </tr>
                        </thead>
                        <tbody id="gamesTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Upload Modal -->
    <div class="modal-overlay" id="uploadModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Upload PGN Games</h2>
                <button class="modal-close" id="closeModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="dropZone" class="drop-zone">
                    <i class="fas fa-cloud-upload-alt file-upload-icon"></i>
                    <p class="file-upload-text">Drag and drop your PGN file here</p>
                    <p class="file-upload-text">or</p>
                    <button class="btn-primary">
                        <i class="fas fa-folder-open"></i>
                        Choose File
                    </button>
                    <input type="file" id="fileInput" class="file-upload-input" accept=".pgn">
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
    <script>
        // Load navigation and initialize dashboard only if authenticated
        document.addEventListener('DOMContentLoaded', () => {
            if (!requireAuth()) {
                console.log('Not authenticated, redirecting to login');
                window.location.replace('/index.html');
                return;
            }

            // Load navigation
            fetch('./partials/nav.html')
                .then(response => response.text())
                .then(data => {
                    document.getElementById('nav-placeholder').innerHTML = data;
                })
                .catch(error => console.error('Error loading navigation:', error));
        });
    </script>
    <script src="./js/nav.js"></script>
    <script src="./js/dashboard.js"></script>
</body>
</html>
